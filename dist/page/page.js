(()=>{var e={254:(e,t,s)=>{var i=s(779);e.exports=(i.default||i).apply(i,[])},373:(e,t,s)=>{var i=s(749);e.exports=(i.default||i).apply(i,[])},827:(e,t,s)=>{var i=s(70);e.exports=(i.default||i).apply(i,[])},779:(e,t,s)=>{s(55),e.exports=function(e){return""+'<div class="menu-container"></div>'}},587:(e,t,s)=>{var i=s(55);e.exports=function(e){var t,s="",n=e||{};return function(e,n){s=s+'<div class="change-level-menu"'+i.attr("style",i.style(`width: ${n}`),!0,!0)+'><a class="wb-level-controller">+</a><a class="wb-level-number">'+i.escape(null==(t=e)?"":t)+'</a><a class="wb-level-controller">-</a></div>'}.call(this,"number"in n?n.number:"undefined"!=typeof number?number:void 0,"width"in n?n.width:"undefined"!=typeof width?width:void 0),s}},749:(e,t,s)=>{s(55),e.exports=function(e){return""+'<div class="page-popup-menu"></div>'}},490:(e,t,s)=>{var i=s(55);e.exports=function(e){var t,s="",n=e||{};return function(e,n,o){s=s+'<div class="display-word-menu"><a class="translate-link" target="_blank"'+i.attr("href",e,!0,!0)+">"+i.escape(null==(t=o)?"":t)+"</a><div><span>cursor-x:</span><span>"+i.escape(null==(t=n.cursor.x)?"":t)+"</span></div><div><span>cursor-y:</span><span>"+i.escape(null==(t=n.cursor.y)?"":t)+"</span></div><div><span>block-width:</span><span>"+i.escape(null==(t=n.block.width)?"":t)+"</span></div><div><span>block-height:</span><span>"+i.escape(null==(t=n.block.height)?"":t)+"</span></div><div><span>text-length:</span><span>"+i.escape(null==(t=n.textLength)?"":t)+"</span></div><div><span>text-blocks-count:</span><span>"+i.escape(null==(t=n.textBlocksCount)?"":t)+"</span></div><div><span>text-block-index:</span><span>"+i.escape(null==(t=n.currentLine)?"":t)+"</span></div><div><span>text-block-size-width:</span><span>"+i.escape(null==(t=n.currentTextBlockSize.width)?"":t)+"</span></div><div><span>text-block-size-height:</span><span>"+i.escape(null==(t=n.currentTextBlockSize.height)?"":t)+"</span></div>\x3c!--div--\x3e\x3c!--    span gap-height:--\x3e\x3c!--    span= netGraph.gapHeight--\x3e\x3c!----\x3e\x3c!--div--\x3e\x3c!--    span count-gaps:--\x3e\x3c!--    span= netGraph.countGaps--\x3e<div><span>real-height:</span><span>"+i.escape(null==(t=n.realHeight)?"":t)+"</span></div><div><span>coefficient:</span><span>"+i.escape(null==(t=n.coefficient)?"":t)+"</span></div>\x3c!--div--\x3e\x3c!--    span text-block-width:--\x3e\x3c!--    span= textBlock.width--\x3e\x3c!--div--\x3e\x3c!--    span text-block-height:--\x3e\x3c!--    span= textBlock.height--\x3e\x3c!--div--\x3e\x3c!--    span index:--\x3e\x3c!--    span= index--\x3e\x3c!--div--\x3e\x3c!--    span line:--\x3e\x3c!--    span= line--\x3e\x3c!--div--\x3e\x3c!--    span text-length:--\x3e\x3c!--    span= length--\x3e\x3c!--div--\x3e\x3c!--    span one-symbol-width:--\x3e\x3c!--    span= one--\x3e\x3c!--div--\x3e\x3c!--    span cursor-offset-width:--\x3e\x3c!--    span= offset.width--\x3e\x3c!--div--\x3e\x3c!--    span cursor-offset-height:--\x3e\x3c!--    span= offset.height--\x3e\x3c!--div--\x3e\x3c!--    span block-width:--\x3e\x3c!--    span= block.width--\x3e\x3c!--div--\x3e\x3c!--    span block-height:--\x3e\x3c!--    span= block.height--\x3e\x3c!--div--\x3e\x3c!--    span cursor-x:--\x3e\x3c!--    span= eventInfo.x--\x3e\x3c!--div--\x3e\x3c!--    span cursor-y:--\x3e\x3c!--    span= eventInfo.y--\x3e\x3c!--.edit-button EDIT--\x3e</div>"}.call(this,"href"in n?n.href:"undefined"!=typeof href?href:void 0,"netGraph"in n?n.netGraph:"undefined"!=typeof netGraph?netGraph:void 0,"word"in n?n.word:"undefined"!=typeof word?word:void 0),s}},70:(e,t,s)=>{s(55),e.exports=function(e){return""+"<style>.menu-container {\n    text-align: center;\n}\n\n.page-popup-menu {\n    position: fixed;\n    user-select: none;\n    color: #1e81c6;\n    z-index: 1000;\n    transition: all 0.2s ease;\n    background: white;\n    border: 1px #1e81c6 solid;\n    padding: 2px;\n    border-radius: 4px;\n}\n\na {\n    text-decoration: none;\n}\n\na:hover {\n    text-decoration: none;\n}\n\n.wb-level-controller {\n    cursor: pointer;\n}\n\n.wb-level-number {\n    color: #444\n}\n\n.change-level-menu {\n    height: 30px;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-around;\n    align-items: center;\n    font-family: Impact, serif;\n    position: relative;\n    font-size: 18px;\n    z-index: 1001;\n    border-radius: 8px;\n    background: #f9f9ff;\n    border: 1px #1e81c6 solid;\n}\n\n.display-word-menu {\n    display: flex;\n    flex-direction: column;\n    grid-gap:4px;\n    margin: 4px 8px;\n    padding-bottom: 2px;\n    font-size: 12px;\n}\n\n.display-word-menu a {\n    line-height: normal;\n    text-decoration: none;\n    color: #1e81c6;\n    border-bottom: 1px #1e81c6 solid;\n}\n\n.display-word-menu div {\n    display: flex;\n    flex-direction: row;\n    grid-gap: 4px;\n}\n\n.display-word-menu .edit-button {\n    margin-left: 4px;\n    font-family: Impact, serif;\n}</style>"}},55:(e,t,s)=>{"use strict";var i=Object.prototype.hasOwnProperty;function n(e,t){return Array.isArray(e)?function(e,t){for(var s,i="",o="",r=Array.isArray(t),a=0;a<e.length;a++)(s=n(e[a]))&&(r&&t[a]&&(s=c(s)),i=i+o+s,o=" ");return i}(e,t):e&&"object"==typeof e?function(e){var t="",s="";for(var n in e)n&&e[n]&&i.call(e,n)&&(t=t+s+n,s=" ");return t}(e):e||""}function o(e){if(!e)return"";if("object"==typeof e){var t="";for(var s in e)i.call(e,s)&&(t=t+s+":"+e[s]+";");return t}return e+""}function r(e,t,s,i){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(i?e:e+'="'+e+'"');var n=typeof t;return"object"!==n&&"function"!==n||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),s||-1===t.indexOf('"'))?(s&&(t=c(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}t.merge=function e(t,s){if(1===arguments.length){for(var i=t[0],n=1;n<t.length;n++)i=e(i,t[n]);return i}for(var r in s)if("class"===r){var a=t[r]||[];t[r]=(Array.isArray(a)?a:[a]).concat(s[r]||[])}else if("style"===r){a=(a=o(t[r]))&&";"!==a[a.length-1]?a+";":a;var c=o(s[r]);c=c&&";"!==c[c.length-1]?c+";":c,t[r]=a+c}else t[r]=s[r];return t},t.classes=n,t.style=o,t.attr=r,t.attrs=function(e,t){var s="";for(var a in e)if(i.call(e,a)){var c=e[a];if("class"===a){s=r(a,c=n(c),!1,t)+s;continue}"style"===a&&(c=o(c)),s+=r(a,c,!1,t)}return s};var a=/["&<>]/;function c(e){var t=""+e,s=a.exec(t);if(!s)return e;var i,n,o,r="";for(i=s.index,n=0;i<t.length;i++){switch(t.charCodeAt(i)){case 34:o="&quot;";break;case 38:o="&amp;";break;case 60:o="&lt;";break;case 62:o="&gt;";break;default:continue}n!==i&&(r+=t.substring(n,i)),n=i+1,r+=o}return n!==i?r+t.substring(n,i):r}t.escape=c,t.rethrow=function e(t,i,n,o){if(!(t instanceof Error))throw t;if(!("undefined"==typeof window&&i||o))throw t.message+=" on line "+n,t;try{o=o||s(835).readFileSync(i,"utf8")}catch(s){e(t,null,n)}var r=3,a=o.split("\n"),c=Math.max(n-r,0),h=Math.min(a.length,n+r);throw r=a.slice(c,h).map((function(e,t){var s=t+c+1;return(s==n?"  > ":"    ")+s+"| "+e})).join("\n"),t.path=i,t.message=(i||"Pug")+":"+n+"\n"+r+"\n\n"+t.message,t}},835:()=>{}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,s),o.exports}(()=>{"use strict";class e{log=e=>{window.console.log("Reckue language app: "+e)};#e=e=>{window.console.log(e.textContent),window.console.log(e.toString()),window.console.log(e.parentNode.toString()),window.console.log(e.parentNode.nodeName),window.console.log(e.parentNode.role)}}const t=new Map;class i{static add=(e,s)=>{t.set(e,s)};static get=e=>t.get(e);static getWordbookService=()=>{const e=i.get("wordbook");if(e)return e}}class n{appParams=()=>new Promise((e=>{chrome.storage.local.get(["enable","russian","english","china","korean"],(t=>{i.add("settings",t),e(t.enable)}))}));saveWordbooks=e=>{chrome.storage.local.set(e)};getByName=e=>new Promise((t=>chrome.storage.local.get([e],(s=>t(s[e])))))}class o{#t;#s;#i;constructor(e,t){this.#t=e,this.#i=t}getCount=()=>this.#s;calcPagesCount=()=>(this.#s=Math.ceil(this.#t/this.#i),this.#s);isIndexOnPage=(e,t)=>t>=this.#n(e)&&t<this.#o(e);#n=e=>e*this.#i;#o=e=>(e+1)*this.#i}class r{#r;#a;constructor(){this.#a=new Map,this.#r=new o(0,0)}remove=e=>{this.#a.delete(e),this.#r=new o(this.#a.size,50),this.#r.calcPagesCount()};set=e=>(e.forEach((e=>{this.#a.set(e.word,e.level)})),this.#r=new o(this.#a.size,50),this.#r.calcPagesCount(),this);get=()=>this.#a;getPages=()=>this.#r;getPage=e=>{let t=0;const s=new Map;return this.#a.forEach(((i,n)=>{this.#r.isIndexOnPage(e,t)&&s.set(n,i),t++})),s};toObject=()=>{const e={};return this.#c().forEach(((t,s)=>{e[this.getName(s)]=t})),e};getName=e=>"wordbook"+e;#h=()=>{const e=[];return this.#a.forEach(((t,s)=>{e.push({word:s,level:t})})),e};#c=()=>{const e=[[]];return this.#h().forEach((t=>this.#l(e,t))),e};#l=(e,t)=>{const s=e.length-1;e[s].length<100?e[s].push(t):(e.push([]),this.#l(e,t))}}class a{#d;#u;#g;#p;executeAfter=e=>{this.#p=e};constructor(){this.#d=new n,this.#u=new e,this.#g=new r}set=e=>{this.#g.set(e),this.#f()};remove=e=>{this.#g.remove(e),this.#f()};#f=()=>{const e=this.#g.toObject();this.#d.saveWordbooks(e)};getWordbook=()=>this.#g;getFilteredWordbook=e=>{const t=[];this.#g.get().forEach(((s,i)=>i&&i.includes(e)&&t.push({word:i,level:s})));const s=new r;return s.set(t),s};getWordbookCache=()=>this.#g.get();loadWordbooks=()=>{this.#x(0)};#x=e=>{const t=this.#g.getName(e);this.#u.log(`Loaded ${t} from storage`),this.#d.getByName(t).then((t=>this.#w(t,e)))};#w=(e,t)=>{e?(this.#g.set(e),this.#m(t)):this.#p()};#m=e=>{const t=e+1;this.#x(t)}}class c{toElement=e=>{const t=window.document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}}class h{#b;constructor(){this.#b=new c}append=()=>{const e=s(827),t=this.#b.toElement(e);window.document.querySelector("head").appendChild(t)}}class l{#b;constructor(){this.#b=new c}getHTMLMapper=()=>this.#b}class d extends l{#v;constructor(e){super();const t=s(254);this.#v=this.getHTMLMapper().toElement(t),e.appendChild(this.#v)}setRef=e=>{this.#v=e};getRef=()=>this.#v}const u=Object.freeze({NATIVE:{name:"native",hex:"#2e8801",number:4},ADVANCED:{name:"advanced",hex:"#72d400",number:3},INTERMEDIATE:{name:"intermediate",hex:"#ef9f00",number:2},ELEMENTARY:{name:"elementary",hex:"#ab0000",number:1},BEGINNER:{name:"beginner",hex:"#ff2a00",number:0}});class g{onHover(e,t){const s=i.get("menu");e.addEventListener("click",(e=>this.#k(e,s,t))),e.addEventListener("mouseout",s.displayOff)}#k=(e,t,s)=>{t.displayOn(),t.setPosition(e.clientX,e.clientY),t.setContent(s)};onHoverAll=e=>{i.get("refs").get(e).forEach((t=>{this.onHover(t,e)}))};renderAll=(e,t)=>{i.get("refs").get(e).forEach((e=>{this.resolveColor(e,t)}))};createRef=e=>{const t=document.createElement("a");return e=e.replace(/\r?\n/g,""),t.innerText=e,t.style.cursor="pointer",t};resolveColor=(e,t)=>{switch(t){case u.NATIVE.name:e.style.color=u.NATIVE.hex;break;case u.ADVANCED.name:e.style.color=u.ADVANCED.hex;break;case u.INTERMEDIATE.name:e.style.color=u.INTERMEDIATE.hex;break;case u.ELEMENTARY.name:e.style.color=u.ELEMENTARY.hex;break;case u.BEGINNER.name:e.style.color=u.BEGINNER.hex}}}class p extends d{#y;#E;#S;constructor(e,t){super(e),this.#y=i.getWordbookService(),this.#S=t,this.#E=new g}updateLevel=()=>{const e=this.#y.getWordbookCache().get(this.#S);this.#T(u[e.toUpperCase()].number)};setWord=e=>{this.#S=e};#C=e=>{const t=e+1;this.#P(t)};#L=e=>{if(e>0){const t=e-1;this.#P(t)}};#P=e=>{this.#B(e,((e,t)=>{this.#T(e),this.#E.renderAll(this.#S,t.name),this.#y.set([{word:this.#S,level:t.name}])}))};#B=(e,t)=>{var s,i;s=u,i=s=>s.number===e&&t(e,s),Object.entries(s).forEach((e=>{const t=e[1];i(t)}))};#T=e=>{const t=s(587),i=this.getHTMLMapper().toElement(t(this.#R(e)));this.#A(i),this.#H(e)};#A=e=>{this.getRef().replaceWith(e),this.setRef(e)};#H=e=>{const t=this.getRef().getElementsByClassName("wb-level-controller");t[0].addEventListener("click",(()=>this.#C(e))),t[1].addEventListener("click",(()=>this.#L(e)))};#R=e=>({number:e,width:i.get("POPUP_WIDTH")+"px"})}class f extends d{#I;#M;constructor(e){super(e),this.#I=s(490),this.#M=e,this.#M.prepend(this.getRef())}updateLink=(e,t)=>{const s=this.#I({word:e,netGraph:t}),i=this.getHTMLMapper().toElement(s),n=this.getRef();this.setRef(i),this.#M.replaceChild(this.getRef(),n)};#N=e=>{const t=i.get("language"),s=`${i.get("TRANSLATE_URL")}&sl=${t.sl}&tl=${t.tl}&text=${e}`;return this.#z(s),s};#z=e=>{window.console.log(chrome.tabs),window.open(e,"_blank").close()}}class x{#v;#b;#W;#O;#G="0";#Q="0";constructor(){this.#b=new c,i.add("POPUP_WIDTH",120),i.add("TRANSLATE_URL","https://translate.google.com/#view=home&op=translate"),this.#q()}setContent=(e,t)=>{this.#O.setWord(e),this.#W.updateLink(e,t),this.#$()};setPosition=(e,t)=>{const s=i.get("POPUP_WIDTH")/2;this.#G=e-s+"px",this.#Q=`${t}px`,this.#D()};displayOn=()=>{this.#v.style.visibility="visible"};displayOff=()=>{this.#v.style.visibility="hidden"};#U=()=>{window.document.querySelector("body").appendChild(this.#v)};#q=()=>{const e=s(373);this.#v=this.#b.toElement(e),this.displayOff(),this.#F(),this.#W=new f(this.#v),this.#O=new p(this.#v),this.#U()};#D=()=>{this.#v.style.left=this.#G,this.#v.style.top=this.#Q};#F(){this.#v.addEventListener("mouseover",(()=>this.displayOn())),this.#v.addEventListener("mouseout",(()=>this.displayOff()))}#$=()=>{const e=this.#j(this.#W.getRef().offsetWidth),t=this.#j(i.get("POPUP_WIDTH"))-e;this.#W.getRef().style.left=`${t}px`};#j=e=>e/2}class w{#y;#S;#Y;constructor(e){this.#S=e,this.#Y=new g,this.#y=i.getWordbookService()}create=()=>{if(""===this.#S.get())return this.#V();const e=this.#Y.createRef(this.#S.get().trim()),t=this.#y.getWordbookCache().get(this.#S.getClear());return this.#_(t)?this.#X(e,t):this.#J(e)};#V=()=>document.createTextNode(this.#S.get());#X=(e,t)=>(this.#Y.onHover(e,this.#S.getClear()),this.#Y.resolveColor(e,t),e);#J=e=>(this.#K(),e.addEventListener("click",this.#Z,{once:!0}),e);#Z=()=>{const e=u.BEGINNER.name,t=this.#S.getClear();this.#y.set([{word:t,level:e}]),this.#Y.renderAll(t,e),this.#Y.onHoverAll(this.#S.getClear())};#K=()=>" "!==this.#S.getClear()&&i.get("notSavedWords").add(this.#S.getClear());#_=e=>void 0!==e}class m{#u=new e;constructor(){i.add("menu",new x),i.add("notSavedWords",new Set),i.add("refs",new Map)}rebuildPage=()=>{this.#ee((e=>this.#te(e.ref,e.words)))};#ee=e=>{this.#u.log("Rebuilding page..."),i.get("render-queue").takeTurns(e),this.#u.log("Rebuilding page complete!"),this.#u.log(`Found not saved words - ${i.get("notSavedWords").size}`)};#te=(e,t)=>{"A"!==e.parentNode.nodeName&&(t.forEach((t=>{const s=this.#se(t);""!==s.textContent&&(this.#ie(t.getClear(),s),this.#ne(s,e))})),e.textContent="")};#ie=(e,t)=>{const s=i.get("refs");let n=s.get(e);!n&&(n=[]),n.push(t),s.set(e,n)};#se=e=>""!==e.get()?new w(e).create():this.#oe(" ");#ne=(e,t)=>{t.after(e,t)};#oe=e=>document.createTextNode(e)}class b{#re;constructor(){this.#re=new MutationObserver((e=>this.#ae(e)))}listen=e=>{this.#re.observe(e,{childList:!0})};#ae=e=>{i.get("render-queue").isActive()||e.forEach((e=>this.#ce(e)))};#ce=e=>{e.addedNodes.forEach((e=>{i.get("page-elements-queue").queueUp(e)}))}}class v{#u;#he;#le;#de;constructor(){this.#u=new e,this.#he=new b,this.#le=i.get("page-elements-queue"),this.#de=i.get("text-elements-queue")}putInQueue=e=>{this.#le.queueUp(e)};parse=()=>{this.#u.log("Started queued parser."),this.#le.takeTurns(this.#ue)};#ge=(e,t)=>{if("BODY"===e.nodeName){const s=(100*t/e.childNodes.length).toFixed(2);this.#u.log(`processed ${s}% of the page!`)}};#ue=e=>{e.childNodes.forEach(((t,s)=>{this.#ge(e,s),this.#pe(t)&&this.#fe(t)}))};#pe=e=>!(this.#xe(e)||this.#we(e)||this.#me(e)||this.#be(e)||this.#ve(e)||this.#ke(e)||this.#ye(e)||this.#Ee(e)||this.#Se(e)||this.#Te(e));#xe=e=>e instanceof HTMLScriptElement;#Ee=e=>e instanceof HTMLFormElement;#me=e=>e instanceof HTMLImageElement;#be=e=>e instanceof HTMLInputElement;#ve=e=>e instanceof HTMLLinkElement;#ye=e=>e instanceof HTMLStyleElement;#ke=e=>e instanceof HTMLBRElement;#we=e=>e instanceof SVGSVGElement;#Se=e=>e instanceof Comment;#Te=e=>"CODE"===e.nodeName||"A"===e.nodeName;#fe=e=>{e.hasChildNodes()?(this.#he.listen(e),this.#ue(e)):this.#de.queueUp(e)}}class k{getRegex=()=>new RegExp(this.#Ce(this.#Pe()));#Ce=e=>`[^${e}]+`;#Pe=()=>""===this.#Le()?"\\w":this.#Le();#Le=()=>this.#Be()+this.#Be().toUpperCase()+this.#Re()+this.#Re().toUpperCase()+this.#Ae()+this.#He();#Be=()=>i.get("settings").russian?"йцукенгшщзхъфывапролджэячсмитьбю":"";#Re=()=>i.get("settings").english?"yqwertuiopasdfghjklzxcvbnm":"";#Ae=()=>i.get("settings").korean?"ㄱㄴㄷㄹㅁㅂㅅㅇㅈㅊㅋㅌㅍㅎㅏㅓㅗㅜㅡㅣㅑㅕㅛㅠㄲㄸㅃㅆㅉㄳㄵㄶㄺㄻㄼㄽㄾㄿㅀㅄㅐㅒㅔㅖㅘㅙㅚㅝㅞㅟㅢ":"";#He=()=>i.get("settings").china?"一丁丂七丄丅丆万丈三上下丌不与丏丐丑丒专且丕世丗丘丙业丛东丝丞丟丠両丢丣两严並丧丨丩个丫丬中丮丯丰丱串丳临丵丶丷丸丹为主丼丽举丿乀乁乂乃乄久乆乇么义乊之乌乍乎乏乐乑乒乓乔乕乪乫乬乭乮乯买乱乲乳乴乵乶乷乸乹乺乻乼乽乾乿亀亁亂亃亄亅了亇予争亊事二亍于亏亐云互亓五井亖亗亘亙亚些亜亝亞亟亠亡亢亣交亥亦产亨亩亪享京亭亮亯亰亱亲亳亴亵亶亷亸亹人亻亼亽亾亿什仁仂仃仄仅仆仇仈仉今介仌仍从仏仐仑仒仓仔仕他仗付仙仚仛仜仝仞仟仠仡仢代令以仦仧仨仩仪仫们仭仮仯仰仱仲仳仴仵件价仸仹仺任仼份仾仿伀企伂伃伄伅伆伇伈伉伊伋伌伍伎伏伐休伒伓伔伕伖众优伙会伛伜伝伞伟传伡伢伣伤伥伦伧伨伩伪伫伬伭伮伯估伱伲伳伴伵伶伷伸伹伺伻似伽伾伿佀佁佂佃佄佅但佇佈佉佊佋佌位低住佐佑佒体佔何佖佗佘余佚佛作佝佞佟你佡佢佣佤佥佦佧佨佩佪佫佬佭佮佯佰佱佲佳佴併佶佷佸佹佺佻佼佽佾使侀侁侂侃侄侅來侇侈侉侊例侌侍侎侏侐侑侒侓侔侕侖侗侘侙侚供侜依侞侟侠価侢侣侤侥侦侧侨侩侪侫侬侭侮侯侰侱侲侳侴侵侶侷侸侹侺侻侼侽侾便俀俁係促俄俅俆俇俈俉俊俋俌俍俎俏俐俑俒俓俔俕俖俗俘俙俚俛俜保俞俟俠信俢俣俤俥俦俧俨俩俪俫俬俭修俯俰俱俲俳俴俵俶俷俸俹俺俻俼俽俾俿倀倁倂倃倄倅倆倇倈倉倊個倌倍倎倏倐們倒倓倔倕倖倗倘候倚倛倜倝倞借倠倡倢倣値倥倦倧倨倩倪倫倬倭倮倯倰倱倲倳倴倵倶倷倸倹债倻值倽倾倿偀偁偂偃偄偅偆假偈偉偊偋偌偍偎偏偐偑偒偓偔偕偖偗偘偙做偛停偝偞偟偠偡偢偣偤健偦偧偨偩偪偫偬偭偮偯偰偱偲偳側偵偶偷偸偹偺偻偼偽偾偿傀傁傂傃傄傅傆傇傈傉傊傋傌傍傎傏傐傑傒傓傔傕傖傗傘備傚傛傜傝傞傟傠傡傢傣傤傥傦傧储傩傪傫催傭傮傯傰傱傲傳傴債傶傷傸傹傺傻傼傽傾傿僀僁僂僃僄僅僆僇僈僉僊僋僌働僎像僐僑僒僓僔僕僖僗僘僙僚僛僜僝僞僟僠僡僢僣僤僥僦僧僨僩僪僫僬僭僮僯僰僱僲僳僴僵僶僷僸價僺僻僼僽僾僿儀儁儂儃億儅儆儇儈儉儊儋儌儍儎儏儐儑儒儓儔儕儖儗儘儙儚儛儜儝儞償儠儡儢儣儤儥儦儧儨儩優儫儬儭儮儯儰儱儲儳儴儵儶儷儸儹儺儻儼儽儾儿兀允兂元兄充兆兇先光兊克兌免兎兏児兑兒兓兔兕兖兗兘兙党兛兜兝兞兟兠兡兢兣兤入兦內全兩兪八公六兮兯兰共兲关兴兵其具典兹兺养兼兽兾兿冀冁冂冃冄内円冇冈冉冊冋册再冎冏冐冑冒冓冔冕冖冗冘写冚军农冝冞冟冠冡冢冣冤冥冦冧冨冩冪冫冬冭冮冯冰冱冲决冴况冶冷冸冹冺冻冼冽冾冿净凁凂凃凄凅准凇凈凉凊凋凌凍凎减凐凑凒凓凔凕凖凗凘凙凚凛凜凝凞凟几凡凢凣凤凥処凧凨凩凪凫凬凭凮凯凰凱凲凳凴凵凶凷凸凹出击凼函凾凿刀刁刂刃刄刅分切刈刉刊刋刌刍刎刏乖乗乘乙乚乛乜九乞也习乡乢乣乤乥书乧乨乩":""}class y{#Ce;#Ie;#Me;constructor(e){this.#Ce=new k,this.#Ie=e,this.#Ne()}get=()=>this.#Ie;getClear=()=>this.#Me;#Ne=()=>{this.#Me=this.#Ie.toString().toLowerCase().replace(this.#Ce.getRegex(),""),this.#ze(this.#Me)||this.#We()};#We=()=>{let e=null;this.#Me.endsWith("s")&&(e="s"),this.#Me.endsWith("ed")&&(e="ed"),this.#Me.endsWith("ing")&&(e="ing"),null!==e&&this.#Oe(e)};#Ge=()=>{this.#Me.startsWith("un")&&this.#Qe("un")};#Oe=e=>{this.#Me=this.#Me.substr(0,this.#Me.length-e.length),this.#qe(this.#Me)};#Qe=e=>{this.#Me=this.#Me.substr(e.length-1)};#qe=e=>{this.#ze(e)||(this.#ze(e+"s")&&(this.#Me=e+"s"),this.#ze(e+"e")&&(this.#Me=e+"e"))};#ze=e=>i.getWordbookService().getWordbookCache().get(e)}class E{#de;#$e;#g;constructor(){this.#g=i.getWordbookService().getWordbookCache(),this.#de=i.get("text-elements-queue"),this.#$e=i.get("render-queue")}parse=()=>{this.#de.takeTurns((e=>{const t=this.#De(e);this.#Ue(e,t)}))};#De=e=>{const t=e.textContent.split(" ");return this.#Fe(t)};#Fe=e=>{const t=[];return e.forEach(((e,s)=>{0!==s&&t.push(""),this.#je(t,e,"-")||this.#je(t,e,".")||this.#je(t,e,"...")||this.#je(t,e,",")||this.#Ye(t,e)})),t};#Ye=(e,t)=>{t.endsWith("n't")&&!t.includes("can't")?this.#Ve(e,t,"n't","not"):t.endsWith("'ll")?this.#Ve(e,t,"'ll","will"):e.push(t)};#Ve=(e,t,s,i)=>{const n=this.#_e(t,s);e.push(n,"",i)};#_e=(e,t)=>{const s=this.#Xe(e,t);return this.#Je(s)};#Xe=(e,t)=>e.substr(0,e.length-t.length);#Je=e=>this.#ze(e)?e:this.#ze(e+"e")?e+"e":e;#ze=e=>this.#g.get(e);#je=(e,t,s)=>{const i=t.split(s);if(2===i.length){const t=i[0],n=i[1];return e.push(t,s,n),!0}return!1};#Ue=(e,t)=>{const s=[];t.forEach((e=>s.push(new y(e)))),this.#$e.queueUp({ref:e,words:s})}}class S{#Ke;#Ze;constructor(){this.#Ke=new v,this.#Ze=new E}textBlocksParsing=e=>this.#Ze.parse(e);parsePage=()=>{this.#Ke.parse()};putInQueue=e=>{this.#Ke.putInQueue(e)}}class T{#et;#tt;constructor(){this.#et=!1,this.#tt=new Set}queueUp=e=>{this.#tt.add(e)};takeTurns=e=>{this.#et=!0,this.#tt.forEach((t=>e(t))),this.#tt.clear(),this.#et=!1};isEmpty=()=>0===this.#tt.size;isActive=()=>this.#et}class C{#st;#it;#u;constructor(){i.add("render-queue",new T),i.add("page-elements-queue",new T),i.add("text-elements-queue",new T),this.#u=new e,this.#it=new S,this.#st=new m}runInfinityParsing=()=>{this.#nt(),this.#ot()};#nt=()=>{let e=window.document.querySelector("body");this.#it.putInQueue(e),setInterval((()=>{this.#rt()&&this.#at()&&this.#it.parsePage()}),100)};#ot=()=>{setInterval((()=>{this.#rt()&&this.#ct()&&this.#it.textBlocksParsing()}),100)};runInfinityRender=()=>{setInterval((()=>{this.#ht()&&this.#st.rebuildPage()}),100)};#ht=()=>{const e=i.get("render-queue");return!e.isActive()&&!e.isEmpty()};#rt=()=>!i.get("render-queue").isActive();#at=()=>{const e=i.get("page-elements-queue");return!e.isActive()&&!e.isEmpty()};#ct=()=>{const e=i.get("text-elements-queue");return!e.isActive()&&!e.isEmpty()}}class P{static draw;#lt;#dt;constructor(e,t){this.#dt=e,this.#lt=t}draw=()=>{P.draw&&window.document.body.removeChild(P.draw),P.draw=window.document.createElement("div"),P.draw.style.left=`${this.#dt.getPosition().x}px`,P.draw.style.top=`${this.#dt.getPosition().y}px`,P.draw.style.width=`${this.#dt.getSize().width}px`,P.draw.style.height=`${this.#dt.getSize().height}px`,P.draw.style.position="absolute",P.draw.style.zIndex="1000",P.draw.style.opacity="0.25",P.draw.style.pointerEvents="none",P.draw.style.border="1px solid black",window.document.body.appendChild(P.draw),this.#ut()};#ut(){this.#lt.getBlocks().forEach(((e,t)=>{const s=e.getSize(),i=this.#lt.getPosition(t),n=window.document.createElement("div");n.innerText=t,n.style.left=`${i.x}px`,n.style.top=`${i.y}px`,n.style.width=`${s.width}px`,n.style.height=`${s.height}px`,n.style.position="absolute",n.style.background="blue",n.style.border="1px solid black",n.style.zIndex="1000",n.style.opacity=e.isEmpty()?"0":"0.25",P.draw.appendChild(n)}))}}class L{#gt;#pt;constructor(e,t){this.#gt=e,this.#pt=t}get width(){return this.#gt}get height(){return this.#pt}set width(e){this.#gt=e}set height(e){this.#pt=e}}class B{#ft;#v;#xt;#wt="left:0;top:0;position:absolute;z-index:100";constructor(e,t){this.#xt=t,this.#v=e}getSize=e=>{const t=this.#mt();return this.#ft=document.createElement("div"),this.#bt(t),this.#vt(),this.#kt(e,t)};#kt=(e,t)=>{parent.document.body.appendChild(this.#ft);const s=this.#yt(e);this.#Et(e,t,s);const i=this.#St(),n=this.#Tt();this.#Et(e,t,n);const o=this.#St();return parent.document.body.removeChild(this.#ft),{block:i,inline:o}};#St=()=>new L(this.#ft.offsetWidth,this.#ft.offsetHeight);#Et=(e,t,s)=>{const i=t.fontSize,n=t.fontFamily,o=this.#Ct(i,n),r=this.#Pt(o,s);this.#Lt(r)};#Ct=(e,t)=>`${this.#wt};\n                font-size:${e};\n                font-family:${t};`;#Lt=e=>document.all?this.#ft.style.setAttribute("cssText",e):this.#ft.setAttribute("style",e);#yt=e=>`width:${e.width}px;height:auto`;#Tt=()=>"height:auto;width:auto";#bt=e=>{this.#ft.style=e};#mt=()=>window.getComputedStyle(this.#v);#vt(){this.#ft.innerHTML=this.#v.innerHTML,this.#ft.innerText=this.#xt}#Pt=(e,t)=>`${e}${t}`}class R{#Bt;#dt;#Rt;#xt;#At;#Ht;#It;#Mt;#Nt;#zt;#lt;constructor(e,t){this.#Rt=e,this.#lt=t;try{this.#Wt(e),this.#Ot(e),this.#Gt(e),this.#Ht={cursor:this.#Bt,block:this.#dt,textLength:this.#xt.length},this.#Mt=this.getTextBlocks().map((t=>{const s=new B(e.target,t).getSize(this.#dt);return s.height||(s.height=20),s})),this.#Nt=this.#Mt.reduce(((e,t)=>e+t.height),0),this.#zt=this.#dt.height/this.#Nt,this.#Ht.coefficient=this.#zt,this.#Ht.realHeight=this.#Nt;const t=this.getTextBlockIndex();this.#Ht.currentLine=t,this.#Ht.textBlocksCount=this.getTextBlocks().length,this.#It=this.getTextBlocks()[t],this.#At=new B(e.target,this.#It)}catch(e){}}getWord=()=>{const e=this.getCurrentTextBlockSize();console.log(e);const t=this.getCursorPercentageX(e);console.log(t);const s=1/this.#It.length;console.log(s);const i=Math.floor(t/s);console.log(i);const n=[""];return this.#Qt(n,this.#It,i,((e,t,s)=>(e[0]=e[0]+t,s+1))),this.#Qt(n,this.#It,i-1,((e,t,s)=>(e[0]=t+e[0],s-1))),console.log(n),n[0]};getNetGraph=()=>this.#Ht;getText=()=>this.#xt;getTextBlocks=()=>{const e=this.getText().split("\n"),t=e.pop();return t&&e.push(t),e};getCurrentTextBlockSize=()=>{const e=this.#At.getSize(this.#dt).inline;return this.#Ht.currentTextBlockSize={...e},e};getCursorPercentageX=e=>this.#Bt.x/e.width;getTextBlockIndex=()=>{if(!this.#Bt)return;let e=0,t=0;for(;this.#Bt.y>e;)e+=this.#Mt[t].height*this.#zt,t++;return t-1};#Wt=e=>{if(!e.target)throw new DOMException;this.#xt=e.target.innerText};#Ot=e=>{this.#Bt={},this.#Bt.x=e.offsetX,this.#Bt.y=e.offsetY};#Gt=e=>{this.#dt={},this.#dt.width=e.target.offsetWidth,this.#dt.height=e.target.offsetHeight,this.#dt.x=e.target.offsetLeft,this.#dt.y=e.target.offsetTop;let t=e.target.offsetParent;for(;t&&t.offsetParent;)t=t.offsetParent,this.#dt.x+=t.offsetLeft,this.#dt.y+=t.offsetTop};#Qt=(e,t,s,i)=>{let n=t[s];if(this.#qt(n)){const o=i(e,n,s);this.#Qt(e,t,o,i)}};#qt=e=>e&&" "!==e&&"."!==e&&","!==e&&"“"!==e&&"”"!==e&&"!"!==e&&"?"!==e}class A{#$t;#xt;#Dt;constructor(e,t){this.#xt=t,this.#$t=!(t.trim().length>0),this.#Ut(e)}getSize=()=>this.#Dt.block;getInlineSize=()=>this.#Dt.inline;getLinesCount=()=>this.#Dt.block.height/this.#Dt.inline.height;getLineHeight=()=>this.#Dt.inline.height;setLineHeight=e=>{this.#Dt.inline.height=e};isEmpty=()=>this.#$t;#Ut=e=>{const t=e.getRef(),s=new B(t,this.#Ft());this.#Dt=s.getSize(e.getSize())};#Ft=()=>this.isEmpty()?"0":this.#xt}class H{#v;#jt;#Yt;#Vt;#Nt;constructor(e){this.#v=e.getRef(),this.#_t(),this.#Xt(e),this.#Jt(e)}getBlocks=()=>this.#Vt;getPositions=()=>this.#Yt;getPosition=e=>this.#Yt[e];#Xt=e=>{this.#Nt=0,this.#Vt=this.#jt.map((t=>{const s=new A(e,t);return this.#Nt+=this.#Kt(s),s}))};#Zt=()=>{this.#Nt=0,this.#Yt=[],this.#Vt.forEach((e=>{this.#Yt.push({x:0,y:this.#Nt}),this.#Nt+=this.#Kt(e)}))};#Kt=e=>e.isEmpty()?e.getLineHeight():e.getSize().height;#Jt=e=>{const t=e.getSize().height/this.#Nt;this.#Vt.forEach((e=>{e.getSize().height*=t,e.isEmpty()?e.setLineHeight(e.getSize().height):e.setLineHeight(e.getLineHeight()*t)})),this.#Zt()};#_t(){this.#jt=this.#v.innerText.split("\n");const e=this.#jt.pop();e&&this.#jt.push(e)}}class I{#es;#Ze;constructor(e,t){this.#es=e,this.#Ze=t}getFocusBlock=()=>this.#es;getTextBlocks=()=>this.#Ze}class M{#v;#Dt;#ts;#ss;constructor(e){this.#v=e.target,this.#ss=this.#v.getBoundingClientRect(),this.#Ut(),this.#is()}getRef=()=>this.#v;getSize=()=>this.#Dt;getPosition=()=>this.#ts;#is=()=>{const e=this.#ss.x+window.scrollX,t=this.#ss.y+window.scrollY;this.#ts={x:e,y:t}};#Ut=()=>{const e=this.#ss.width,t=this.#ss.height;this.#Dt={width:e,height:t}}}class N{#ns;#os;constructor(){this.#ns=new Set,this.#os=new Map}getOrUpdateCache=e=>{let t=this.getCache(e);return t||(this.#rs(e).length>0?t=this.#as(e):this.#ns.add(e.target)),t};getCache=e=>this.#os.get(e.target);validateNoneBlackListElement=(e,t)=>{this.#ns.has(e.target)||t()};#as=e=>{const t=this.#cs(e),s=new H(t),i=new I(t,s);return this.#os.set(e.target,i),i};#cs=e=>new M(e);#rs=e=>Array.from(e.target.childNodes).filter((e=>"#text"===e.nodeName))}class z{#hs;constructor(){this.#hs=new N}run=()=>{addEventListener("click",this.onclick),addEventListener("mousemove",this.onmousemove),addEventListener("scroll",this.onmousemove)};onclick=e=>{let t=this.#hs.getCache(e);if(t){const s=t.getTextBlocks().getBlocks(),n=t.getTextBlocks().getPositions();let o=0;for(;n[o]&&n[o].y<e.offsetY;)o++;const r=o-1,a=n[r],c=s[r];console.log(e.offsetY,a.y),console.log(e.offsetY-a.y,c.getLineHeight()),console.log(Math.floor((e.offsetY-a.y)/c.getLineHeight())),console.log(a,c);const h=new R(e,t.getTextBlocks()),l=h.getWord();console.log(l);const d=i.get("menu"),u=window.document.querySelector(".page-popup-menu"),g=h.getNetGraph();d.displayOn(),d.setContent(l,g),d.setPosition(window.innerWidth-u.offsetWidth,window.innerHeight-u.offsetHeight-20)}};onmousemove=e=>{this.#hs.validateNoneBlackListElement(e,(()=>{let t=this.#hs.getOrUpdateCache(e);new P(t.getFocusBlock(),t.getTextBlocks()).draw(),this.onclick(e)}))}}const W=new class{#u;#ls;#d;#ds;constructor(){this.#u=new e,this.#d=new n,this.#ls=new h,this.#ds=new z}run=()=>{this.#d.appParams().then((e=>{this.#us(e)}))};#us=e=>{e&&(i.add("menu",new x),this.#ls.append(),this.#ds.run())};#gs=()=>{i.add("language",{sl:"en",tl:"ru"});const e=new C;e.runInfinityParsing(),e.runInfinityRender()}};new class{#ps;#y;#fs;constructor(e){this.#ps=new i,this.#fs=e,this.#y=new a}start=()=>{this.#y.executeAfter(this.#xs),this.#y.loadWordbooks()};#xs=()=>{i.add("wordbook",this.#y),this.#fs.run()}}(W).start()})()})();