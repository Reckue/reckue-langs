(()=>{var e={254:(e,t,s)=>{var n=s(779);e.exports=(n.default||n).apply(n,[])},373:(e,t,s)=>{var n=s(749);e.exports=(n.default||n).apply(n,[])},827:(e,t,s)=>{var n=s(70);e.exports=(n.default||n).apply(n,[])},779:(e,t,s)=>{s(55),e.exports=function(e){return""+'<div class="menu-container"></div>'}},587:(e,t,s)=>{var n=s(55);e.exports=function(e){var t,s="",i=e||{};return function(e,i){s=s+'<div class="change-level-menu"'+n.attr("style",n.style(`width: ${i}`),!0,!0)+'><a class="wb-level-controller">+</a><a class="wb-level-number">'+n.escape(null==(t=e)?"":t)+'</a><a class="wb-level-controller">-</a></div>'}.call(this,"number"in i?i.number:"undefined"!=typeof number?number:void 0,"width"in i?i.width:"undefined"!=typeof width?width:void 0),s}},749:(e,t,s)=>{s(55),e.exports=function(e){return""+'<div class="page-popup-menu"></div>'}},490:(e,t,s)=>{var n=s(55);e.exports=function(e){var t,s="",i=e||{};return function(e,i,o){s=s+'<div class="display-word-menu"><a class="translate-link" target="_blank"'+n.attr("href",e,!0,!0)+">"+n.escape(null==(t=o)?"":t)+"</a><div><span>cursor-x:</span><span>"+n.escape(null==(t=i.cursor.x)?"":t)+"</span></div><div><span>cursor-y:</span><span>"+n.escape(null==(t=i.cursor.y)?"":t)+"</span></div><div><span>block-width:</span><span>"+n.escape(null==(t=i.block.width)?"":t)+"</span></div><div><span>block-height:</span><span>"+n.escape(null==(t=i.block.height)?"":t)+"</span></div><div><span>text-length:</span><span>"+n.escape(null==(t=i.textLength)?"":t)+"</span></div><div><span>text-blocks-count:</span><span>"+n.escape(null==(t=i.textBlocksCount)?"":t)+"</span></div><div><span>text-block-index:</span><span>"+n.escape(null==(t=i.currentLine)?"":t)+"</span></div><div><span>text-block-size-width:</span><span>"+n.escape(null==(t=i.currentTextBlockSize.width)?"":t)+"</span></div><div><span>text-block-size-height:</span><span>"+n.escape(null==(t=i.currentTextBlockSize.height)?"":t)+"</span></div>\x3c!--div--\x3e\x3c!--    span gap-height:--\x3e\x3c!--    span= netGraph.gapHeight--\x3e\x3c!----\x3e\x3c!--div--\x3e\x3c!--    span count-gaps:--\x3e\x3c!--    span= netGraph.countGaps--\x3e<div><span>real-height:</span><span>"+n.escape(null==(t=i.realHeight)?"":t)+"</span></div><div><span>coefficient:</span><span>"+n.escape(null==(t=i.coefficient)?"":t)+"</span></div>\x3c!--div--\x3e\x3c!--    span text-block-width:--\x3e\x3c!--    span= textBlock.width--\x3e\x3c!--div--\x3e\x3c!--    span text-block-height:--\x3e\x3c!--    span= textBlock.height--\x3e\x3c!--div--\x3e\x3c!--    span index:--\x3e\x3c!--    span= index--\x3e\x3c!--div--\x3e\x3c!--    span line:--\x3e\x3c!--    span= line--\x3e\x3c!--div--\x3e\x3c!--    span text-length:--\x3e\x3c!--    span= length--\x3e\x3c!--div--\x3e\x3c!--    span one-symbol-width:--\x3e\x3c!--    span= one--\x3e\x3c!--div--\x3e\x3c!--    span cursor-offset-width:--\x3e\x3c!--    span= offset.width--\x3e\x3c!--div--\x3e\x3c!--    span cursor-offset-height:--\x3e\x3c!--    span= offset.height--\x3e\x3c!--div--\x3e\x3c!--    span block-width:--\x3e\x3c!--    span= block.width--\x3e\x3c!--div--\x3e\x3c!--    span block-height:--\x3e\x3c!--    span= block.height--\x3e\x3c!--div--\x3e\x3c!--    span cursor-x:--\x3e\x3c!--    span= eventInfo.x--\x3e\x3c!--div--\x3e\x3c!--    span cursor-y:--\x3e\x3c!--    span= eventInfo.y--\x3e\x3c!--.edit-button EDIT--\x3e</div>"}.call(this,"href"in i?i.href:"undefined"!=typeof href?href:void 0,"netGraph"in i?i.netGraph:"undefined"!=typeof netGraph?netGraph:void 0,"word"in i?i.word:"undefined"!=typeof word?word:void 0),s}},70:(e,t,s)=>{s(55),e.exports=function(e){return""+"<style>.menu-container {\n    text-align: center;\n}\n\n.page-popup-menu {\n    position: fixed;\n    user-select: none;\n    color: #1e81c6;\n    z-index: 1000;\n    transition: all 0.2s ease;\n    background: white;\n    border: 1px #1e81c6 solid;\n    padding: 2px;\n    border-radius: 4px;\n}\n\na {\n    text-decoration: none;\n}\n\na:hover {\n    text-decoration: none;\n}\n\n.wb-level-controller {\n    cursor: pointer;\n}\n\n.wb-level-number {\n    color: #444\n}\n\n.change-level-menu {\n    height: 30px;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-around;\n    align-items: center;\n    font-family: Impact, serif;\n    position: relative;\n    font-size: 18px;\n    z-index: 1001;\n    border-radius: 8px;\n    background: #f9f9ff;\n    border: 1px #1e81c6 solid;\n}\n\n.display-word-menu {\n    display: flex;\n    flex-direction: column;\n    grid-gap:4px;\n    margin: 4px 8px;\n    padding-bottom: 2px;\n    font-size: 12px;\n}\n\n.display-word-menu a {\n    line-height: normal;\n    text-decoration: none;\n    color: #1e81c6;\n    border-bottom: 1px #1e81c6 solid;\n}\n\n.display-word-menu div {\n    display: flex;\n    flex-direction: row;\n    grid-gap: 4px;\n}\n\n.display-word-menu .edit-button {\n    margin-left: 4px;\n    font-family: Impact, serif;\n}</style>"}},55:(e,t,s)=>{"use strict";var n=Object.prototype.hasOwnProperty;function i(e,t){return Array.isArray(e)?function(e,t){for(var s,n="",o="",r=Array.isArray(t),a=0;a<e.length;a++)(s=i(e[a]))&&(r&&t[a]&&(s=l(s)),n=n+o+s,o=" ");return n}(e,t):e&&"object"==typeof e?function(e){var t="",s="";for(var i in e)i&&e[i]&&n.call(e,i)&&(t=t+s+i,s=" ");return t}(e):e||""}function o(e){if(!e)return"";if("object"==typeof e){var t="";for(var s in e)n.call(e,s)&&(t=t+s+":"+e[s]+";");return t}return e+""}function r(e,t,s,n){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(n?e:e+'="'+e+'"');var i=typeof t;return"object"!==i&&"function"!==i||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),s||-1===t.indexOf('"'))?(s&&(t=l(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}t.merge=function e(t,s){if(1===arguments.length){for(var n=t[0],i=1;i<t.length;i++)n=e(n,t[i]);return n}for(var r in s)if("class"===r){var a=t[r]||[];t[r]=(Array.isArray(a)?a:[a]).concat(s[r]||[])}else if("style"===r){a=(a=o(t[r]))&&";"!==a[a.length-1]?a+";":a;var l=o(s[r]);l=l&&";"!==l[l.length-1]?l+";":l,t[r]=a+l}else t[r]=s[r];return t},t.classes=i,t.style=o,t.attr=r,t.attrs=function(e,t){var s="";for(var a in e)if(n.call(e,a)){var l=e[a];if("class"===a){s=r(a,l=i(l),!1,t)+s;continue}"style"===a&&(l=o(l)),s+=r(a,l,!1,t)}return s};var a=/["&<>]/;function l(e){var t=""+e,s=a.exec(t);if(!s)return e;var n,i,o,r="";for(n=s.index,i=0;n<t.length;n++){switch(t.charCodeAt(n)){case 34:o="&quot;";break;case 38:o="&amp;";break;case 60:o="&lt;";break;case 62:o="&gt;";break;default:continue}i!==n&&(r+=t.substring(i,n)),i=n+1,r+=o}return i!==n?r+t.substring(i,n):r}t.escape=l,t.rethrow=function e(t,n,i,o){if(!(t instanceof Error))throw t;if(!("undefined"==typeof window&&n||o))throw t.message+=" on line "+i,t;var r,a,l,c;try{o=o||s(835).readFileSync(n,{encoding:"utf8"}),r=3,a=o.split("\n"),l=Math.max(i-r,0),c=Math.min(a.length,i+r)}catch(s){return t.message+=" - could not read from "+n+" ("+s.message+")",void e(t,null,i)}r=a.slice(l,c).map((function(e,t){var s=t+l+1;return(s==i?"  > ":"    ")+s+"| "+e})).join("\n"),t.path=n;try{t.message=(n||"Pug")+":"+i+"\n"+r+"\n\n"+t.message}catch(e){}throw t}},835:()=>{}},t={};function s(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,s),o.exports}(()=>{"use strict";class e{log=e=>{window.console.log("Reckue language app: "+e)};#e=e=>{window.console.log(e.textContent),window.console.log(e.toString()),window.console.log(e.parentNode.toString()),window.console.log(e.parentNode.nodeName),window.console.log(e.parentNode.role)}}const t=new Map;class n{static add=(e,s)=>{t.set(e,s)};static get=e=>t.get(e);static getWordbookService=()=>{const e=n.get("wordbook");if(e)return e}}class i{appParams=()=>new Promise((e=>{chrome.storage.local.get(["enable","russian","english","china","korean"],(t=>{n.add("settings",t),e(t.enable)}))}));saveWordbooks=e=>{chrome.storage.local.set(e)};getByName=e=>new Promise((t=>chrome.storage.local.get([e],(s=>t(s[e])))))}class o{#t;#s;#n;constructor(e,t){this.#t=e,this.#n=t}getCount=()=>this.#s;calcPagesCount=()=>(this.#s=Math.ceil(this.#t/this.#n),this.#s);isIndexOnPage=(e,t)=>t>=this.#i(e)&&t<this.#o(e);#i=e=>e*this.#n;#o=e=>(e+1)*this.#n}class r{#r;#a;constructor(){this.#a=new Map,this.#r=new o(0,0)}remove=e=>{this.#a.delete(e),this.#r=new o(this.#a.size,50),this.#r.calcPagesCount()};set=e=>(e.forEach((e=>{this.#a.set(e.word,e.level)})),this.#r=new o(this.#a.size,50),this.#r.calcPagesCount(),this);get=()=>this.#a;getPages=()=>this.#r;getPage=e=>{let t=0;const s=new Map;return this.#a.forEach(((n,i)=>{this.#r.isIndexOnPage(e,t)&&s.set(i,n),t++})),s};toObject=()=>{const e={};return this.#l().forEach(((t,s)=>{e[this.getName(s)]=t})),e};getName=e=>"wordbook"+e;#c=()=>{const e=[];return this.#a.forEach(((t,s)=>{e.push({word:s,level:t})})),e};#l=()=>{const e=[[]];return this.#c().forEach((t=>this.#h(e,t))),e};#h=(e,t)=>{const s=e.length-1;e[s].length<100?e[s].push(t):(e.push([]),this.#h(e,t))}}class a{#d;#p;#u;#g;executeAfter=e=>{this.#g=e};constructor(){this.#d=new i,this.#p=new e,this.#u=new r}set=e=>{this.#u.set(e),this.#f()};remove=e=>{this.#u.remove(e),this.#f()};#f=()=>{const e=this.#u.toObject();this.#d.saveWordbooks(e)};getWordbook=()=>this.#u;getFilteredWordbook=e=>{const t=[];this.#u.get().forEach(((s,n)=>n&&n.includes(e)&&t.push({word:n,level:s})));const s=new r;return s.set(t),s};getWordbookCache=()=>this.#u.get();loadWordbooks=()=>{this.#x(0)};#x=e=>{const t=this.#u.getName(e);this.#p.log(`Loaded ${t} from storage`),this.#d.getByName(t).then((t=>this.#w(t,e)))};#w=(e,t)=>{e?(this.#u.set(e),this.#v(t)):this.#g()};#v=e=>{const t=e+1;this.#x(t)}}class l{toElement=e=>{const t=window.document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}}class c{#m;constructor(){this.#m=new l}append=()=>{const e=s(827),t=this.#m.toElement(e);window.document.querySelector("head").appendChild(t)}}class h{#m;constructor(){this.#m=new l}getHTMLMapper=()=>this.#m}class d extends h{#b;constructor(e){super();const t=s(254);this.#b=this.getHTMLMapper().toElement(t),e.appendChild(this.#b)}setRef=e=>{this.#b=e};getRef=()=>this.#b}const p=Object.freeze({NATIVE:{name:"native",hex:"#2e8801",number:4},ADVANCED:{name:"advanced",hex:"#72d400",number:3},INTERMEDIATE:{name:"intermediate",hex:"#ef9f00",number:2},ELEMENTARY:{name:"elementary",hex:"#ab0000",number:1},BEGINNER:{name:"beginner",hex:"#ff2a00",number:0}});class u{onHover(e,t){const s=n.get("menu");e.addEventListener("click",(e=>this.#y(e,s,t))),e.addEventListener("mouseout",s.displayOff)}#y=(e,t,s)=>{t.displayOn(),t.setPosition(e.clientX,e.clientY),t.setContent(s)};onHoverAll=e=>{n.get("refs").get(e).forEach((t=>{this.onHover(t,e)}))};renderAll=(e,t)=>{n.get("refs").get(e).forEach((e=>{this.resolveColor(e,t)}))};createRef=e=>{const t=document.createElement("a");return e=e.replace(/\r?\n/g,""),t.innerText=e,t.style.cursor="pointer",t};resolveColor=(e,t)=>{switch(t){case p.NATIVE.name:e.style.color=p.NATIVE.hex;break;case p.ADVANCED.name:e.style.color=p.ADVANCED.hex;break;case p.INTERMEDIATE.name:e.style.color=p.INTERMEDIATE.hex;break;case p.ELEMENTARY.name:e.style.color=p.ELEMENTARY.hex;break;case p.BEGINNER.name:e.style.color=p.BEGINNER.hex}}}class g extends d{#k;#E;#S;constructor(e,t){super(e),this.#k=n.getWordbookService(),this.#S=t,this.#E=new u}updateLevel=()=>{const e=this.#k.getWordbookCache().get(this.#S);this.#C(p[e.toUpperCase()].number)};setWord=e=>{this.#S=e};#P=e=>{const t=e+1;this.#T(t)};#L=e=>{if(e>0){const t=e-1;this.#T(t)}};#T=e=>{this.#R(e,((e,t)=>{this.#C(e),this.#E.renderAll(this.#S,t.name),this.#k.set([{word:this.#S,level:t.name}])}))};#R=(e,t)=>{var s,n;s=p,n=s=>s.number===e&&t(e,s),Object.entries(s).forEach((e=>{const t=e[1];n(t)}))};#C=e=>{const t=s(587),n=this.getHTMLMapper().toElement(t(this.#I(e)));this.#A(n),this.#N(e)};#A=e=>{this.getRef().replaceWith(e),this.setRef(e)};#N=e=>{const t=this.getRef().getElementsByClassName("wb-level-controller");t[0].addEventListener("click",(()=>this.#P(e))),t[1].addEventListener("click",(()=>this.#L(e)))};#I=e=>({number:e,width:n.get("POPUP_WIDTH")+"px"})}class f extends d{#M;#z;constructor(e){super(e),this.#M=s(490),this.#z=e,this.#z.prepend(this.getRef())}updateLink=(e,t)=>{const s=this.#M({word:e,netGraph:t}),n=this.getHTMLMapper().toElement(s),i=this.getRef();this.setRef(n),this.#z.replaceChild(this.getRef(),i)};#H=e=>{const t=n.get("language"),s=`${n.get("TRANSLATE_URL")}&sl=${t.sl}&tl=${t.tl}&text=${e}`;return this.#B(s),s};#B=e=>{window.console.log(chrome.tabs),window.open(e,"_blank").close()}}class x{#b;#m;#W;#O;#Q="0";#q="0";constructor(){this.#m=new l,n.add("POPUP_WIDTH",120),n.add("TRANSLATE_URL","https://translate.google.com/#view=home&op=translate"),this.#$()}setContent=(e,t)=>{this.#O.setWord(e),this.#W.updateLink(e,t),this.#D()};setPosition=(e,t)=>{const s=n.get("POPUP_WIDTH")/2;this.#Q=e-s+"px",this.#q=`${t}px`,this.#G()};displayOn=()=>{this.#b.style.visibility="visible"};displayOff=()=>{this.#b.style.visibility="hidden"};#U=()=>{window.document.querySelector("body").appendChild(this.#b)};#$=()=>{const e=s(373);this.#b=this.#m.toElement(e),this.displayOff(),this.#j(),this.#W=new f(this.#b),this.#O=new g(this.#b),this.#U()};#G=()=>{this.#b.style.left=this.#Q,this.#b.style.top=this.#q};#j(){this.#b.addEventListener("mouseover",(()=>this.displayOn())),this.#b.addEventListener("mouseout",(()=>this.displayOff()))}#D=()=>{const e=this.#F(this.#W.getRef().offsetWidth),t=this.#F(n.get("POPUP_WIDTH"))-e;this.#W.getRef().style.left=`${t}px`};#F=e=>e/2}class w{#k;#S;#V;constructor(e){this.#S=e,this.#V=new u,this.#k=n.getWordbookService()}create=()=>{if(""===this.#S.get())return this.#_();const e=this.#V.createRef(this.#S.get().trim()),t=this.#k.getWordbookCache().get(this.#S.getClear());return this.#Y(t)?this.#J(e,t):this.#X(e)};#_=()=>document.createTextNode(this.#S.get());#J=(e,t)=>(this.#V.onHover(e,this.#S.getClear()),this.#V.resolveColor(e,t),e);#X=e=>(this.#K(),e.addEventListener("click",this.#Z,{once:!0}),e);#Z=()=>{const e=p.BEGINNER.name,t=this.#S.getClear();this.#k.set([{word:t,level:e}]),this.#V.renderAll(t,e),this.#V.onHoverAll(this.#S.getClear())};#K=()=>" "!==this.#S.getClear()&&n.get("notSavedWords").add(this.#S.getClear());#Y=e=>void 0!==e}class v{#p=new e;constructor(){n.add("menu",new x),n.add("notSavedWords",new Set),n.add("refs",new Map)}rebuildPage=()=>{this.#ee((e=>this.#te(e.ref,e.words)))};#ee=e=>{this.#p.log("Rebuilding page..."),n.get("render-queue").takeTurns(e),this.#p.log("Rebuilding page complete!"),this.#p.log(`Found not saved words - ${n.get("notSavedWords").size}`)};#te=(e,t)=>{"A"!==e.parentNode.nodeName&&(t.forEach((t=>{const s=this.#se(t);""!==s.textContent&&(this.#ne(t.getClear(),s),this.#ie(s,e))})),e.textContent="")};#ne=(e,t)=>{const s=n.get("refs");let i=s.get(e);!i&&(i=[]),i.push(t),s.set(e,i)};#se=e=>""!==e.get()?new w(e).create():this.#oe(" ");#ie=(e,t)=>{t.after(e,t)};#oe=e=>document.createTextNode(e)}class m{#re;constructor(){this.#re=new MutationObserver((e=>this.#ae(e)))}listen=e=>{this.#re.observe(e,{childList:!0})};#ae=e=>{n.get("render-queue").isActive()||e.forEach((e=>this.#le(e)))};#le=e=>{e.addedNodes.forEach((e=>{n.get("page-elements-queue").queueUp(e)}))}}class b{#p;#ce;#he;#de;constructor(){this.#p=new e,this.#ce=new m,this.#he=n.get("page-elements-queue"),this.#de=n.get("text-elements-queue")}putInQueue=e=>{this.#he.queueUp(e)};parse=()=>{this.#p.log("Started queued parser."),this.#he.takeTurns(this.#pe)};#ue=(e,t)=>{if("BODY"===e.nodeName){const s=(100*t/e.childNodes.length).toFixed(2);this.#p.log(`processed ${s}% of the page!`)}};#pe=e=>{e.childNodes.forEach(((t,s)=>{this.#ue(e,s),this.#ge(t)&&this.#fe(t)}))};#ge=e=>!(this.#xe(e)||this.#we(e)||this.#ve(e)||this.#me(e)||this.#be(e)||this.#ye(e)||this.#ke(e)||this.#Ee(e)||this.#Se(e)||this.#Ce(e));#xe=e=>e instanceof HTMLScriptElement;#Ee=e=>e instanceof HTMLFormElement;#ve=e=>e instanceof HTMLImageElement;#me=e=>e instanceof HTMLInputElement;#be=e=>e instanceof HTMLLinkElement;#ke=e=>e instanceof HTMLStyleElement;#ye=e=>e instanceof HTMLBRElement;#we=e=>e instanceof SVGSVGElement;#Se=e=>e instanceof Comment;#Ce=e=>"CODE"===e.nodeName||"A"===e.nodeName;#fe=e=>{e.hasChildNodes()?(this.#ce.listen(e),this.#pe(e)):this.#de.queueUp(e)}}class y{getRegex=()=>new RegExp(this.#Pe(this.#Te()));#Pe=e=>`[^${e}]+`;#Te=()=>""===this.#Le()?"\\w":this.#Le();#Le=()=>this.#Re()+this.#Re().toUpperCase()+this.#Ie()+this.#Ie().toUpperCase()+this.#Ae()+this.#Ne();#Re=()=>n.get("settings").russian?"йцукенгшщзхъфывапролджэячсмитьбю":"";#Ie=()=>n.get("settings").english?"yqwertuiopasdfghjklzxcvbnm":"";#Ae=()=>n.get("settings").korean?"ㄱㄴㄷㄹㅁㅂㅅㅇㅈㅊㅋㅌㅍㅎㅏㅓㅗㅜㅡㅣㅑㅕㅛㅠㄲㄸㅃㅆㅉㄳㄵㄶㄺㄻㄼㄽㄾㄿㅀㅄㅐㅒㅔㅖㅘㅙㅚㅝㅞㅟㅢ":"";#Ne=()=>n.get("settings").china?"一丁丂七丄丅丆万丈三上下丌不与丏丐丑丒专且丕世丗丘丙业丛东丝丞丟丠両丢丣两严並丧丨丩个丫丬中丮丯丰丱串丳临丵丶丷丸丹为主丼丽举丿乀乁乂乃乄久乆乇么义乊之乌乍乎乏乐乑乒乓乔乕乪乫乬乭乮乯买乱乲乳乴乵乶乷乸乹乺乻乼乽乾乿亀亁亂亃亄亅了亇予争亊事二亍于亏亐云互亓五井亖亗亘亙亚些亜亝亞亟亠亡亢亣交亥亦产亨亩亪享京亭亮亯亰亱亲亳亴亵亶亷亸亹人亻亼亽亾亿什仁仂仃仄仅仆仇仈仉今介仌仍从仏仐仑仒仓仔仕他仗付仙仚仛仜仝仞仟仠仡仢代令以仦仧仨仩仪仫们仭仮仯仰仱仲仳仴仵件价仸仹仺任仼份仾仿伀企伂伃伄伅伆伇伈伉伊伋伌伍伎伏伐休伒伓伔伕伖众优伙会伛伜伝伞伟传伡伢伣伤伥伦伧伨伩伪伫伬伭伮伯估伱伲伳伴伵伶伷伸伹伺伻似伽伾伿佀佁佂佃佄佅但佇佈佉佊佋佌位低住佐佑佒体佔何佖佗佘余佚佛作佝佞佟你佡佢佣佤佥佦佧佨佩佪佫佬佭佮佯佰佱佲佳佴併佶佷佸佹佺佻佼佽佾使侀侁侂侃侄侅來侇侈侉侊例侌侍侎侏侐侑侒侓侔侕侖侗侘侙侚供侜依侞侟侠価侢侣侤侥侦侧侨侩侪侫侬侭侮侯侰侱侲侳侴侵侶侷侸侹侺侻侼侽侾便俀俁係促俄俅俆俇俈俉俊俋俌俍俎俏俐俑俒俓俔俕俖俗俘俙俚俛俜保俞俟俠信俢俣俤俥俦俧俨俩俪俫俬俭修俯俰俱俲俳俴俵俶俷俸俹俺俻俼俽俾俿倀倁倂倃倄倅倆倇倈倉倊個倌倍倎倏倐們倒倓倔倕倖倗倘候倚倛倜倝倞借倠倡倢倣値倥倦倧倨倩倪倫倬倭倮倯倰倱倲倳倴倵倶倷倸倹债倻值倽倾倿偀偁偂偃偄偅偆假偈偉偊偋偌偍偎偏偐偑偒偓偔偕偖偗偘偙做偛停偝偞偟偠偡偢偣偤健偦偧偨偩偪偫偬偭偮偯偰偱偲偳側偵偶偷偸偹偺偻偼偽偾偿傀傁傂傃傄傅傆傇傈傉傊傋傌傍傎傏傐傑傒傓傔傕傖傗傘備傚傛傜傝傞傟傠傡傢傣傤傥傦傧储傩傪傫催傭傮傯傰傱傲傳傴債傶傷傸傹傺傻傼傽傾傿僀僁僂僃僄僅僆僇僈僉僊僋僌働僎像僐僑僒僓僔僕僖僗僘僙僚僛僜僝僞僟僠僡僢僣僤僥僦僧僨僩僪僫僬僭僮僯僰僱僲僳僴僵僶僷僸價僺僻僼僽僾僿儀儁儂儃億儅儆儇儈儉儊儋儌儍儎儏儐儑儒儓儔儕儖儗儘儙儚儛儜儝儞償儠儡儢儣儤儥儦儧儨儩優儫儬儭儮儯儰儱儲儳儴儵儶儷儸儹儺儻儼儽儾儿兀允兂元兄充兆兇先光兊克兌免兎兏児兑兒兓兔兕兖兗兘兙党兛兜兝兞兟兠兡兢兣兤入兦內全兩兪八公六兮兯兰共兲关兴兵其具典兹兺养兼兽兾兿冀冁冂冃冄内円冇冈冉冊冋册再冎冏冐冑冒冓冔冕冖冗冘写冚军农冝冞冟冠冡冢冣冤冥冦冧冨冩冪冫冬冭冮冯冰冱冲决冴况冶冷冸冹冺冻冼冽冾冿净凁凂凃凄凅准凇凈凉凊凋凌凍凎减凐凑凒凓凔凕凖凗凘凙凚凛凜凝凞凟几凡凢凣凤凥処凧凨凩凪凫凬凭凮凯凰凱凲凳凴凵凶凷凸凹出击凼函凾凿刀刁刂刃刄刅分切刈刉刊刋刌刍刎刏乖乗乘乙乚乛乜九乞也习乡乢乣乤乥书乧乨乩":""}class k{#Pe;#Me;#ze;constructor(e){this.#Pe=new y,this.#Me=e,this.#He()}get=()=>this.#Me;getClear=()=>this.#ze;#He=()=>{this.#ze=this.#Me.toString().toLowerCase().replace(this.#Pe.getRegex(),""),this.#Be(this.#ze)||this.#We()};#We=()=>{let e=null;this.#ze.endsWith("s")&&(e="s"),this.#ze.endsWith("ed")&&(e="ed"),this.#ze.endsWith("ing")&&(e="ing"),null!==e&&this.#Oe(e)};#Qe=()=>{this.#ze.startsWith("un")&&this.#qe("un")};#Oe=e=>{this.#ze=this.#ze.substr(0,this.#ze.length-e.length),this.#$e(this.#ze)};#qe=e=>{this.#ze=this.#ze.substr(e.length-1)};#$e=e=>{this.#Be(e)||(this.#Be(e+"s")&&(this.#ze=e+"s"),this.#Be(e+"e")&&(this.#ze=e+"e"))};#Be=e=>n.getWordbookService().getWordbookCache().get(e)}class E{#de;#De;#u;constructor(){this.#u=n.getWordbookService().getWordbookCache(),this.#de=n.get("text-elements-queue"),this.#De=n.get("render-queue")}parse=()=>{this.#de.takeTurns((e=>{const t=this.#Ge(e);this.#Ue(e,t)}))};#Ge=e=>{const t=e.textContent.split(" ");return this.#je(t)};#je=e=>{const t=[];return e.forEach(((e,s)=>{0!==s&&t.push(""),this.#Fe(t,e,"-")||this.#Fe(t,e,".")||this.#Fe(t,e,"...")||this.#Fe(t,e,",")||this.#Ve(t,e)})),t};#Ve=(e,t)=>{t.endsWith("n't")&&!t.includes("can't")?this.#_e(e,t,"n't","not"):t.endsWith("'ll")?this.#_e(e,t,"'ll","will"):e.push(t)};#_e=(e,t,s,n)=>{const i=this.#Ye(t,s);e.push(i,"",n)};#Ye=(e,t)=>{const s=this.#Je(e,t);return this.#Xe(s)};#Je=(e,t)=>e.substr(0,e.length-t.length);#Xe=e=>this.#Be(e)?e:this.#Be(e+"e")?e+"e":e;#Be=e=>this.#u.get(e);#Fe=(e,t,s)=>{const n=t.split(s);if(2===n.length){const t=n[0],i=n[1];return e.push(t,s,i),!0}return!1};#Ue=(e,t)=>{const s=[];t.forEach((e=>s.push(new k(e)))),this.#De.queueUp({ref:e,words:s})}}class S{#Ke;#Ze;constructor(){this.#Ke=new b,this.#Ze=new E}textBlocksParsing=e=>this.#Ze.parse(e);parsePage=()=>{this.#Ke.parse()};putInQueue=e=>{this.#Ke.putInQueue(e)}}class C{#et;#tt;constructor(){this.#et=!1,this.#tt=new Set}queueUp=e=>{this.#tt.add(e)};takeTurns=e=>{this.#et=!0,this.#tt.forEach((t=>e(t))),this.#tt.clear(),this.#et=!1};isEmpty=()=>0===this.#tt.size;isActive=()=>this.#et}class P{#st;#nt;#p;constructor(){n.add("render-queue",new C),n.add("page-elements-queue",new C),n.add("text-elements-queue",new C),this.#p=new e,this.#nt=new S,this.#st=new v}runInfinityParsing=()=>{this.#it(),this.#ot()};#it=()=>{let e=window.document.querySelector("body");this.#nt.putInQueue(e),setInterval((()=>{this.#rt()&&this.#at()&&this.#nt.parsePage()}),100)};#ot=()=>{setInterval((()=>{this.#rt()&&this.#lt()&&this.#nt.textBlocksParsing()}),100)};runInfinityRender=()=>{setInterval((()=>{this.#ct()&&this.#st.rebuildPage()}),100)};#ct=()=>{const e=n.get("render-queue");return!e.isActive()&&!e.isEmpty()};#rt=()=>!n.get("render-queue").isActive();#at=()=>{const e=n.get("page-elements-queue");return!e.isActive()&&!e.isEmpty()};#lt=()=>{const e=n.get("text-elements-queue");return!e.isActive()&&!e.isEmpty()}}class T{#b;#ht;#dt;#pt;constructor(e){this.#b=e.target,this.#pt=this.#b.getBoundingClientRect(),this.#ut(),this.#gt()}#gt=()=>{const e=this.#pt.x+window.scrollX,t=this.#pt.y+window.scrollY;this.#dt={x:e,y:t}};#ut=()=>{const e=this.#pt.width,t=this.#pt.height;this.#ht={width:e,height:t}};getRef=()=>this.#b;getSize=()=>this.#ht;getPosition=()=>this.#dt}class L{static draw;#ft;#xt;constructor(e,t){this.#xt=e,this.#ft=t}draw=()=>{L.draw&&window.document.body.removeChild(L.draw),L.draw=window.document.createElement("div"),L.draw.style.left=`${this.#xt.getPosition().x}px`,L.draw.style.top=`${this.#xt.getPosition().y}px`,L.draw.style.width=`${this.#xt.getSize().width}px`,L.draw.style.height=`${this.#xt.getSize().height}px`,L.draw.style.position="absolute",L.draw.style.zIndex="1000",L.draw.style.opacity="0.25",L.draw.style.pointerEvents="none",L.draw.style.border="1px solid black",window.document.body.appendChild(L.draw),this.#wt()};#wt(){this.#ft.getBlocks().forEach(((e,t)=>{const s=e.getSize(),n=this.#ft.getPosition(t),i=window.document.createElement("div");i.innerText=t,i.style.left=`${n.x}px`,i.style.top=`${n.y}px`,i.style.width=`${s.width}px`,i.style.height=`${s.height}px`,i.style.position="absolute",i.style.background="blue",i.style.border="1px solid black",i.style.zIndex="1000",i.style.opacity=e.isEmpty()?"0":"0.25",i.style.pointerEvents="none",L.draw.appendChild(i)}))}}class R{#vt;#xt;#mt;#bt="left:0;top:0;position:absolute;z-index:100";constructor(e,t){this.#mt=t,this.#xt=e}getSize=e=>{this.#vt=document.createElement("div"),this.#yt(),this.#kt(e),this.#Et(),parent.document.body.appendChild(this.#vt);let t={height:this.#vt.offsetHeight,width:this.#vt.offsetWidth};return parent.document.body.removeChild(this.#vt),t};#kt=e=>{let t=this.#St("fontSize"),s=this.#St("fontFamily"),n="height:auto;width:auto";e&&(n=`width:${e.width}px;height:auto`);const i=`${this.#bt};\n            font-size:${t};\n            font-family:${s};\n            ${n}`;document.all?this.#vt.style.setAttribute("cssText",i):this.#vt.setAttribute("style",i)};#yt=()=>{for(let e in this.#xt.style)try{""!==this.#xt.style[e]&&this.#xt.style[e].indexOf(":")>0&&(this.#vt.style[e]=this.#xt.style[e])}catch(e){}};#St=e=>{let t=this.#xt,s=null;for(;t&&!s;)s=window.getComputedStyle(t)[e],t=t.parentElement;return s};#Et(){this.#vt.innerHTML=this.#xt.innerHTML,this.#vt.innerText=this.#mt}}class I{#Ct;#mt;#ht;#Pt;#Tt;constructor(e,t){this.#mt=t,this.#Ct=!(t.trim().length>0),this.#ut(e,t),this.#Lt(e,t),this.#Tt=this.#ht.height/this.#Pt.height}getSize=()=>this.#ht;getLinesCount=()=>this.#Tt;getLineHeight=()=>this.#Pt.height;setLineHeight=e=>{this.#Pt.height=e};isEmpty=()=>this.#Ct;#ut=(e,t)=>{const s=e.getRef(),n=new R(s,t);this.#ht=n.getSize(e.getSize())};#Lt(e,t){const s=e.getRef(),n=new R(s,this.#Rt(t));this.#Pt=n.getSize()}#Rt=e=>this.isEmpty()?"0":e}class A{#b;#It;#At;#Nt;#Mt;#zt;constructor(e){this.#b=e.getRef(),this.#Ht(),this.#Bt(e);const t=e.getSize().height/this.#Mt;this.#Nt.forEach((e=>{e.getSize().height*=t})),this.#Wt(),this.#Nt.forEach((t=>{t.isEmpty()&&t.setLineHeight(t.getLineHeight()+(e.getSize().height-this.#Mt)/this.#zt)})),this.#Wt(),console.log(this.#Mt,e.getSize().height)}getBlocks=()=>this.#Nt;getPosition=e=>this.#At[e];#Bt=e=>{this.#Nt=this.#It.map((t=>new I(e,t))),this.#Wt()};#Wt=()=>{this.#Mt=0,this.#zt=0,this.#At=[],this.#Nt.forEach((e=>{this.#At.push({x:0,y:this.#Mt}),e.isEmpty()?(this.#zt++,this.#Mt+=e.getLineHeight()):this.#Mt+=e.getSize().height}))};#Ht(){this.#It=this.#b.innerText.split("\n");const e=this.#It.pop();e&&this.#It.push(e)}}class N{#Ot;run=()=>{addEventListener("mousemove",this.onmousemove)};onmousemove=e=>{const t=this.whereWeAre(e);if(!this.sameBlock(t,this.#Ot)){this.#Ot=t;const e=new A(this.#Ot);new L(this.#Ot,e).draw()}};sameBlock=(e,t)=>e&&t&&e.getRef()===t.getRef();whereWeAre=e=>new T(e)}const M=new class{#p;#Qt;#d;#qt;constructor(){this.#p=new e,this.#d=new i,this.#Qt=new c,this.#qt=new N}run=()=>{this.#d.appParams().then((e=>{this.#$t(e)}))};#$t=e=>{e&&(n.add("menu",new x),this.#Qt.append(),this.#qt.run())};#Dt=()=>{n.add("language",{sl:"en",tl:"ru"});const e=new P;e.runInfinityParsing(),e.runInfinityRender()}};new class{#Gt;#k;#Ut;constructor(e){this.#Gt=new n,this.#Ut=e,this.#k=new a}start=()=>{this.#k.executeAfter(this.#jt),this.#k.loadWordbooks()};#jt=()=>{n.add("wordbook",this.#k),this.#Ut.run()}}(M).start()})()})();